<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VINGO ENGINE TEST: EMERGENCY FIX</title>
    <link rel="stylesheet" href="cardeffect.css">
    <style>
        body { background: #050505; color: white; display: flex; flex-direction: column; align-items: center; padding: 40px 20px; margin: 0; font-family: sans-serif; }
        
        /* [핵심] 모든 방해 요소를 무시하고 크기를 고정 */
        .test-grid { display: flex; flex-wrap: wrap; gap: 30px; justify-content: center; width: 100%; margin-top: 30px; }
        
        .card-wrapper { 
            width: 300px !important; 
            height: 420px !important; 
            position: relative !important; 
            perspective: 1500px !important;
            display: block !important;
        }

        /* cardeffect.css의 0px 설정을 덮어씌움 */
        .card { 
            width: 300px !important; 
            height: 420px !important; 
            position: relative !important; 
            display: block !important;
            transform-style: preserve-3d !important;
        }

        .card__front, .card__back { 
            position: absolute !important; 
            top: 0 !important; 
            left: 0 !important;
            width: 300px !important; 
            height: 420px !important;
            backface-visibility: hidden !important; 
            border-radius: 18px; 
            overflow: hidden;
            border: 2px solid #333;
        }

        .card__front { z-index: 2; background: #111; display: flex; flex-direction: column; }
        .card__back { transform: rotateY(180deg) !important; z-index: 1; background: #050505; }
        
        /* 이미지 영역 강제 확보 */
        .img-box { flex: 1; display: flex; align-items: center; justify-content: center; background: #000; }
        img { width: 85%; height: auto; max-height: 85%; object-fit: contain; }
    </style>
</head>
<body>

    <h1 style="color:#ffdf00">EMERGENCY RENDER TEST</h1>
    <p style="color:#666; font-size:12px;">선으로만 보인다면 CSS의 레이아웃 엔진과 충돌하는 것입니다. 강제로 고정했습니다.</p>

    <div class="test-grid" id="test-grid"></div>

    <script>
        const testCards = [
            { id: "a.webp", rarity: "rare holo vmax", color: "#ff007f" },
            { id: "EX_오리지널.webp", rarity: "rare holo galaxy", color: "#ffdf00" },
            { id: "SR_빈미.webp", rarity: "rare holo", color: "#a335ee" }
        ];

        function render(item) {
            const grid = document.getElementById('test-grid');
            const wrapper = document.createElement('div');
            wrapper.className = "card-wrapper";
            
            const card = document.createElement('div');
            card.className = "card";
            card.setAttribute('data-rarity', item.rarity);
            card.style.setProperty('--glow', item.color);

            // 한글 경로 인코딩
            const safePath = `images/${encodeURIComponent(item.id)}`;

            card.innerHTML = `
                <div class="card__translater" style="width:100%; height:100%;">
                    <div class="card__rotator" style="width:100%; height:100%;">
                        <div class="card__front">
                            <div class="img-box">
                                <img src="${safePath}" onerror="this.src='https://dummyimage.com/300x420/ff007f/ffffff&text=Img+NotFound';">
                            </div>
                            <div style="height:100px; background:#181818; padding:15px; border-top:1px solid ${item.color}44;">
                                <div style="font-weight:900; color:${item.color}">${item.id}</div>
                                <div style="font-size:10px; color:#444; margin-top:5px;">FIXED SCALE 300x420</div>
                            </div>
                            <div class="card__shine"></div>
                            <div class="card__glare"></div>
                        </div>
                        <div class="card__back">
                            <img src="images/card_back.webp" style="width:100%; height:100%; object-fit:cover;" onerror="this.src='https://dummyimage.com/300x420/222/555&text=Back+Missing';">
                        </div>
                    </div>
                </div>
            `;

            // 인터랙션 (기울기 및 빛 반사)
            const move = (e) => {
                const rect = card.getBoundingClientRect();
                const cx = e.clientX || (e.touches && e.touches[0].clientX);
                const cy = e.clientY || (e.touches && e.touches[0].clientY);
                const x = cx - rect.left, y = cy - rect.top;
                
                card.classList.add('active', 'interacting');
                card.style.setProperty('--mx', `${(x / rect.width) * 100}%`);
                card.style.setProperty('--my', `${(y / rect.height) * 100}%`);
                card.style.setProperty('--o', '1');
                card.style.setProperty('--rx', `${(x / rect.width - 0.5) * 50}deg`);
                card.style.setProperty('--ry', `${(y / rect.height - 0.5) * -50}deg`);
            };

            const end = () => {
                card.classList.remove('active', 'interacting');
                card.style.setProperty('--o', '0');
                card.style.setProperty('--rx', '0deg');
                card.style.setProperty('--ry', '0deg');
            };

            wrapper.addEventListener('mousemove', move);
            wrapper.addEventListener('touchmove', (e) => { e.preventDefault(); move(e); }, {passive: false});
            wrapper.addEventListener('mouseleave', end);
            wrapper.addEventListener('touchend', end);

            wrapper.appendChild(card);
            grid.appendChild(wrapper);
        }

        testCards.forEach(render);
    </script>
</body>
</html>
