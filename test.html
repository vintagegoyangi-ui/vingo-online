<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VINGO ENGINE TEST (a.webp)</title>
    <link rel="stylesheet" href="cardeffect.css">
    <style>
        body { 
            background: #050505; 
            color: white; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            padding: 50px 20px; 
            margin: 0; 
            font-family: sans-serif; 
        }
        .test-container { 
            width: 300px; 
            aspect-ratio: 3 / 4.4; 
            perspective: 1200px; 
        }
        .status-info {
            background: #111;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 30px;
            border: 1px solid #333;
            font-size: 14px;
            text-align: center;
        }
        /* CSS 미로드 시 대비 레이아웃 */
        .card { position: relative; width: 100%; height: 100%; transform-style: preserve-3d; }
        .card__front, .card__back { 
            position: absolute !important; inset: 0 !important; 
            backface-visibility: hidden !important; border-radius: 15px; 
        }
        .card__back { transform: rotateY(180deg) !important; }
    </style>
</head>
<body>

    <h1>ENGINE TEST: a.webp</h1>
    <div class="status-info">
        현재 <b>images/a.webp</b> 파일을 불러오고 있습니다. <br>
        카드를 마우스로 휘저어 보세요.
    </div>

    <div class="test-container">
        <div class="card" id="test-card" data-rarity="rare holo vmax">
            <div class="card__translater">
                <div class="card__rotator">
                    <div class="card__front">
                        <div style="width:100%; height:100%; background:#000; border:3px solid #ff007f; border-radius:15px; overflow:hidden; display:flex; align-items:center; justify-content:center;">
                            <img src="images/a.webp" style="width:90%; height:auto;" onerror="this.parentElement.style.background='red';">
                        </div>
                        <div class="card__shine"></div>
                        <div class="card__glare"></div>
                    </div>
                    <div class="card__back">
                        <img src="images/card_back.webp" style="width:100%; height:100%; object-fit:cover; border-radius:15px;" onerror="this.src='https://dummyimage.com/300x440/222/fff&text=No+Back+Image'">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const card = document.getElementById('test-card');

        function handleMove(e) {
            const rect = card.getBoundingClientRect();
            const clientX = e.clientX || (e.touches && e.touches[0].clientX);
            const clientY = e.clientY || (e.touches && e.touches[0].clientY);
            if (!clientX || !clientY) return;

            const x = clientX - rect.left;
            const y = clientY - rect.top;
            
            const px = (x / rect.width) * 100;
            const py = (y / rect.height) * 100;

            card.classList.add('active', 'interacting');
            card.style.setProperty('--mx', `${px}%`);
            card.style.setProperty('--my', `${py}%`);
            card.style.setProperty('--posx', `${px}%`);
            card.style.setProperty('--posy', `${py}%`);
            card.style.setProperty('--o', '1');
            card.style.setProperty('--rx', `${(x / rect.width - 0.5) * 50}deg`);
            card.style.setProperty('--ry', `${(y / rect.height - 0.5) * -50}deg`);
            card.style.setProperty('--hyp', Math.sqrt(Math.pow(x - rect.width/2, 2) + Math.pow(y - rect.height/2, 2)) / (rect.width/2));
        }

        function handleEnd() {
            card.classList.remove('active', 'interacting');
            card.style.setProperty('--o', '0');
            card.style.setProperty('--rx', '0deg');
            card.style.setProperty('--ry', '0deg');
        }

        window.addEventListener('mousemove', handleMove);
        window.addEventListener('touchmove', (e) => { handleMove(e); }, {passive: false});
        window.addEventListener('mouseleave', handleEnd);
        window.addEventListener('touchend', handleEnd);
    </script>
</body>
</html>
